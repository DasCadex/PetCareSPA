a)	Por motivos de salud, los dueños de la empresa se ausentarán del país por
6 meses aproximadamente. Por esta razón han dejado a cargo del negocio a una
persona de su confianza la que necesita saber  cuál es el trabajo que desempeña
cada empleado. Para ello, la información que se requiere es el nombre y apellido
del empleado (concatenado) y el nombre del trabajo que desempeña en el formato
que se muestra en el ejemplo y ordenada en forma ascendente por apellido:
*/

'El empleado XY se desempeña como z'

SELECT * FROM empleado;
SELECT * FROM tipo_empleado;

SELECT *
  FROM empleado em
  JOIN tipo_empleado te ON (te.tipo_empleado = em.tipo_empleado);

SELECT 'El empleado '||pnombre||' '||appaterno||' se desempeña como '||desc_tipo_empleado as "PERSONAL DEL EMPRESA"
  FROM empleado em
  JOIN tipo_empleado te ON (te.tipo_empleado = em.tipo_empleado);

/*
b)	El nuevo encargado de la empresa desea saber todas las ventas que se han 
efectuado a la fecha. Para ello saber el nombre y apellido del empleado 
(concatenado) que efectuó la venta, el número de la boleta, fecha de la boleta y
el monto total de la boleta. La información se debe mostrar según el formato del
ejemplo y ordenada por número de boleta en forma ascendente:
*/

SELECT * FROM empleado;
SELECT * FROM ventas;

SELECT *
  FROM ventas vta
  JOIN empleado emp ON (emp.id_empleado = vta.id_empleado);

SELECT pnombre, appaterno, nro_boleta, fecha_boleta, monto_total
  FROM ventas vta
  JOIN empleado emp ON (emp.id_empleado = vta.id_empleado);

SELECT pnombre||' '||appaterno as "NOMBRE EMPLEADO"
     , nro_boleta AS "NUMERO BOLETA"
     , fecha_boleta AS fecha_boleta
     , monto_total AS "MONTO VENTA"
  FROM ventas vta
  JOIN empleado emp ON (emp.id_empleado = vta.id_empleado);

/*
c)	Se ha detectado que en el mes de Marzo los cálculos de comisiones por venta
se efectuaron en forma errónea, calculándose menos del valor que les corresponde. 
Por esta razón, se debe enviar a contabilidad un reporte de las comisiones que 
se pagaron durante el mes de Marzo del 2014. La información que se requiere es 
el nombre y apellido del empleado (concatenados), número de la boleta, monto 
total de la boleta y el valor de la comisión asociado a la boleta. La información 
se debe mostrar en el formato que se presenta en el ejemplo y ordena en forma 
ascendente por apellido y monto total de la boleta:
*/
 
SELECT * FROM ventas;
SELECT * FROM comision_ventas;
SELECT * FROM empleado;

SELECT *
  FROM ventas v
  JOIN comision_ventas cv ON (cv.nro_boleta=v.nro_boleta);

SELECT *
  FROM ventas v
  JOIN comision_ventas cv ON (cv.nro_boleta=v.nro_boleta)
  JOIN empleado e ON (e.id_empleado = v.id_empleado)
 --WHERE TO_CHAR(fecha_boleta,'MM') ='03'
 --WHERE EXTRACT(MONTH FROM fecha_boleta) ='03'
 WHERE fecha_boleta BETWEEN '01-03-2014' AND '31-03-2014'
;

SELECT pnombre || ' ' || appaterno
     , v.nro_boleta
     , monto_total
     , monto_comision
  FROM ventas v
  JOIN comision_ventas cv ON (cv.nro_boleta=v.nro_boleta)
  JOIN empleado e ON (e.id_empleado = v.id_empleado)
 WHERE fecha_boleta BETWEEN '01-03-2014' AND '31-03-2014'
 ORDER by appaterno, nro_boleta DESC
;

SELECT pnombre || ' ' || appaterno AS "NOMBRE EMPLEADO"
     , v.nro_boleta AS "NUMERO BOLETA"
     , TO_CHAR(monto_total,'$999g999') AS "MONTO BOLETA"
     , TO_CHAR(monto_comision,'$99g999') AS "COMISION POR VENTA"
  FROM ventas v
  JOIN comision_ventas cv ON (cv.nro_boleta=v.nro_boleta)
  JOIN empleado e ON (e.id_empleado = v.id_empleado)
 WHERE fecha_boleta BETWEEN '01-03-2014' AND '31-03-2014'
 ORDER BY appaterno, v.nro_boleta DESC
;

/*
d)	Se desea saber cuál es el monto total de las ventas y comisiones de los 
vendedores que efectuaron alguna venta en el mes de Marzo del 2014. La 
información que se requiere es el nombre y apellido del empleado (concatenados), 
monto total de sus ventas y monto de sus comisiones de acuerdo al formato que se 
muestra en el ejemplo y ordenada por el total de comisión del mes:
*/
 
SELECT * FROM ventas;
SELECT * FROM comision_ventas;
SELECT * FROM empleado;

SELECT *
  FROM ventas v
  JOIN comision_ventas cv ON (cv.nro_boleta=v.nro_boleta);

SELECT *
  FROM ventas v
  JOIN comision_ventas cv ON (cv.nro_boleta=v.nro_boleta)
  JOIN empleado e ON (e.id_empleado = v.id_empleado)
 WHERE fecha_boleta BETWEEN '01-03-2014' AND '31-03-2014';

SELECT pnombre || ' ' || appaterno
     , SUM(monto_total)
     , SUM(monto_comision)
  FROM ventas v
  JOIN comision_ventas cv ON (cv.nro_boleta=v.nro_boleta)
  JOIN empleado e ON (e.id_empleado = v.id_empleado)
 WHERE fecha_boleta BETWEEN '01-03-2014' AND '31-03-2014'
 GROUP BY pnombre || ' ' || appaterno
